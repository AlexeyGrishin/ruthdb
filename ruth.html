//<html><head></head><body><div id='d'></div><div id='isserver' style='display:none'><form action='/' method='get'><textarea name='data' id='data'></textarea><input type='submit'/></form></div></body></html><script>window.onload=function(){function e(e){document.getElementById(e).innerHTML=data}document.body.removeChild(document.body.firstChild),e("d"),e("data"),0!=location.href.indexOf("file")&&(document.getElementById("isserver").style.display="block")};</script><!--
function save(e){var t=fs.openSync(filepath,"r+"),a=fs.fstatSync(t).size,r=a-data.length-tail.length,s=new Buffer(e+tail);fs.writeSync(t,s,0,s.length,r),data=e,fs.truncateSync(t,r+data.length+tail.length),fs.closeSync(t)}function runServer(){http.createServer(function(e,t){var a=url.parse(e.url,!0);"GET"!=e.method||a.query.data?(save(a.query.data),t.writeHead(302,{Location:"/"}),t.end()):(t.writeHead(200,{"Content-Type":"text/html"}),fs.createReadStream(filepath).pipe(t))}).listen(4444)}function main(){if(process.argv[2])switch(process.argv[2]){case"get":console.log(data);break;case"set":save(process.argv[3]);break;case"server":runServer();break;default:console.log("usage: node.js db.html (get|set <data>)")}else console.log("usage: node.js db.html (get|set <data>)")}var fs=require("fs"),http=require("http"),url=require("url");module.exports={load:function(){return data},save:function(e){data=e}};var filepath=__filename,tail='";//</script>';filepath==process.argv[1]&&setTimeout(main,0);//--><script>//<!--
var data="Hello world!";//</script>